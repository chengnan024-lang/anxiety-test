<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‹çˆ±ä¾æ‹ç±»å‹æµ‹è¯• | ä½ å±äºå“ªç§ä¾æ‹é£æ ¼ï¼Ÿ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%); min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 15px; }
        .container { background: white; border-radius: 20px; padding: 30px 20px; max-width: 480px; width: 100%; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.3); position: relative; }
        h1 { color: #333; font-size: 24px; margin-bottom: 10px; }
        h2 { color: #333; font-size: 18px; margin-bottom: 15px; }
        .subtitle { color: #666; font-size: 14px; margin-bottom: 20px; line-height: 1.6; }
        .tag { display: inline-block; background: linear-gradient(135deg, #ff6b6b 0%, #ffa07a 100%); color: white; padding: 6px 14px; border-radius: 20px; font-size: 12px; margin-bottom: 15px; }
        
        .btn { background: linear-gradient(135deg, #ff6b6b 0%, #ffa07a 100%); color: white; border: none; padding: 16px 24px; font-size: 15px; border-radius: 50px; cursor: pointer; transition: all 0.3s; width: 100%; margin-bottom: 12px; text-align: left; display: flex; justify-content: space-between; align-items: center; }
        .btn:hover { transform: scale(1.02); box-shadow: 0 8px 25px rgba(255,107,107,0.4); }
        .btn-right { font-size: 13px; opacity: 0.8; }
        .btn-title { font-weight: bold; font-size: 16px; }
        .btn-desc { font-size: 12px; opacity: 0.8; display: block; margin-top: 4px; }
        .btn-premium { background: linear-gradient(135deg, #ffa07a 0%, #ff6b6b 100%); }
        
        .tip { color: #999; font-size: 12px; margin-top: 20px; }
        
        .question { display: none; text-align: left; }
        .question.active { display: block; }
        .question h2 { color: #333; font-size: 18px; margin-bottom: 25px; line-height: 1.6; font-weight: 500; }
        .progress { color: #999; font-size: 13px; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .progress-bar { flex: 1; height: 4px; background: #eee; border-radius: 2px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #ff6b6b, #ffa07a); transition: width 0.3s; }
        .option { display: block; width: 100%; padding: 14px 18px; margin-bottom: 10px; border: 2px solid #eee; border-radius: 12px; background: white; font-size: 15px; cursor: pointer; transition: all 0.2s; text-align: left; }
        .option:hover { border-color: #ff6b6b; }
        
        .calculating { display: none; }
        .calculating.active { display: block; }
        .dot { animation: dot 1.5s infinite; }
        @keyframes dot { 0%, 20% { opacity: 0; } 50% { opacity: 1; } 80%, 100% { opacity: 0; } }
        
        .result { display: none; }
        .result.active { display: block; }
        
        .attachment-type { font-size: 36px; margin: 20px 0; }
        .type-name { font-size: 28px; font-weight: bold; color: #ff6b6b; margin-bottom: 10px; }
        .type-desc { font-size: 16px; color: #666; margin-bottom: 20px; line-height: 1.8; }
        
        .section { text-align: left; margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee; }
        .section h3 { font-size: 15px; color: #333; margin-bottom: 12px; }
        .detail-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f5f5f5; font-size: 14px; }
        .detail-label { color: #666; }
        .detail-value { color: #333; font-weight: 500; }
        
        .locked { display: none; }
        .locked.show { display: block; }
        
        .pay-btn { background: linear-gradient(135deg, #ffa07a 0%, #ff6b6b 100%); margin-top: 15px; justify-content: center; }
        .pay-btn.show { display: flex; }
        
        .free-btn { background: #07c160; margin-top: 10px; justify-content: center; }
        
        .tip-red { color: #e74c3c; font-size: 12px; margin-top: 15px; padding: 10px; background: #fff5f5; border-radius: 8px; text-align: left; }
        
        .feature-box { background: linear-gradient(135deg, #fff5f5 0%, #fff0f5 100%); border-radius: 12px; padding: 15px; margin: 15px 0; text-align: left; }
        .feature-box h4 { color: #ff6b6b; font-size: 14px; margin-bottom: 10px; }
        .feature-item { font-size: 13px; color: #666; padding: 5px 0; }
        
        .psycho-section { background: linear-gradient(135deg, #2d1f3d 0%, #1a1a2e 100%); border-radius: 12px; padding: 20px; margin: 15px 0; text-align: left; }
        .psycho-section h4 { color: #ffa07a; font-size: 14px; margin-bottom: 15px; }
        .psycho-content { font-size: 13px; color: #d4d4d8; line-height: 1.9; text-align: left; }
        .psycho-content p { margin-bottom: 12px; }
        .highlight { color: #ffa07a; font-weight: bold; }
        .term { color: #4ecca3; font-style: italic; }
        
        .wechat-pay { background: #07c160; }
        .alipay { background: #1677ff; }
    </style>
</head>
<body>
    <!-- é¦–é¡µ -->
    <div class="container" id="home">
        <span class="tag">å°çº¢ä¹¦çƒ­é—¨ Â· æ‹çˆ±å¿…æµ‹</span>
        <h1>æ‹çˆ±ä¾æ‹ç±»å‹æµ‹è¯•</h1>
        <p class="subtitle">åŸºäºä¾æ‹ç†è®º<br>å‘ç°ä½ çš„æ‹çˆ±æ½œæ„è¯†</p>
        
        <button class="btn" onclick="start(10)">
            <div>
                <div class="btn-title">å¿«é€Ÿç‰ˆ <span style="background:#07c160;color:white;padding:2px 8px;border-radius:10px;font-size:10px;">å…è´¹</span></div>
                <span class="btn-desc">10é“é¢˜ Â· 1åˆ†é’Ÿ</span>
            </div>
            <span class="btn-right">å…è´¹</span>
        </button>
        
        <button class="btn" onclick="start(16)">
            <div>
                <div class="btn-title">æ ‡å‡†ç‰ˆ</div>
                <span class="btn-desc">16é“é¢˜ Â· 3åˆ†é’Ÿ</span>
            </div>
            <span class="btn-right">å…è´¹</span>
        </button>
        
        <button class="btn btn-premium" onclick="start(25)">
            <div>
                <div class="btn-title">æ·±åº¦ç‰ˆ <span style="background:#fff;color:#ff6b6b;padding:2px 8px;border-radius:10px;font-size:10px;">æ¨è</span></div>
                <span class="btn-desc">25é“é¢˜ Â· å«æ·±åº¦è§£æ</span>
            </div>
            <span class="btn-right">Â¥2.99</span>
        </button>
        
        <p class="tip">æœ¬æµ‹è¯•ä»…ä¾›å‚è€ƒï¼Œä¸æ„æˆæƒ…æ„Ÿå»ºè®®</p>
    </div>

    <!-- è®¡ç®—é¡µ -->
    <div class="container calculating" id="calculating">
        <h1>æ­£åœ¨åˆ†æä¸­...</h1>
        <p class="subtitle">
            <span id="calc-text">æ­£åœ¨è§£æä½ çš„æ‹çˆ±ä¾æ‹æ¨¡å¼<span class="dot">.</span><span class="dot">.</span><span class="dot">.</span></span>
        </p>
    </div>

    <!-- ç­”é¢˜é¡µ -->
    <div class="container question" id="quiz">
        <div class="progress">
            <span id="progress-text">1/25</span>
            <div class="progress-bar"><div class="progress-fill" id="progress-fill" style="width: 4%"></div></div>
        </div>
        <h2 id="questionText"></h2>
        <div id="options"></div>
    </div>

    <!-- ç»“æœé¡µ -->
    <div class="container result" id="result">
        <span class="tag">æµ‹è¯„å®Œæˆ</span>
        
        <div class="attachment-type" id="emoji">ğŸ’•</div>
        <div class="type-name" id="typeName">å®‰å…¨å‹</div>
        <div class="type-desc" id="typeDesc">ä½ æ‹¥æœ‰å¥åº·çš„ä¾æ‹æ¨¡å¼</div>
        
        <div class="section">
            <h3>ğŸ“Š ä¾æ‹ç»´åº¦åˆ†æ</h3>
            <div class="detail-item">
                <span class="detail-label">ç„¦è™‘æ°´å¹³</span>
                <span class="detail-value" id="anxietyLevel">-</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">å›é¿æ°´å¹³</span>
                <span class="detail-value" id="avoidanceLevel">-</span>
            </div>
        </div>
        
        <div class="section">
            <h3>ğŸ’• æ‹çˆ±ç‰¹å¾</h3>
            <div class="detail-item">
                <span class="detail-label">äº²å¯†éœ€æ±‚</span>
                <span class="detail-value" id="intimacyNeed">-</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">ç‹¬ç«‹éœ€æ±‚</span>
                <span class="detail-value" id="independenceNeed">-</span>
            </div>
            <div class="detail-item">
                <span class="detail-label">è¡¨è¾¾æ–¹å¼</span>
                <span class="detail-value" id="expressionStyle">-</span>
            </div>
        </div>
        
        <div class="locked" id="locked-section">
            <div class="feature-box">
                <h4>ğŸ”’ è§£é”æ·±åº¦åˆ†æ</h4>
                <p style="color:#666;font-size:13px;margin-bottom:10px;">Â¥2.99è§£é”ï¼š</p>
                <div class="feature-item">â‘  ä¾æ‹ç±»å‹æ·±åº¦è§£è¯»</div>
                <div class="feature-item">â‘¡ åŸç”Ÿå®¶åº­å½±å“åˆ†æ</div>
                <div class="feature-item">â‘¢ æ‹çˆ±æ¨¡å¼æˆå› </div>
                <div class="feature-item">â‘£ å…³ç³»æ”¹è¿›å»ºè®®</div>
                <div class="feature-item">â‘¤ ç²¾ç¥åˆ†ææ½œæ„è¯†è§£è¯»</div>
            </div>
        </div>
        
        <button class="btn pay-btn" id="payBtn" onclick="showPay()">
            <div style="text-align:center;width:100%;">
                <div class="btn-title">ç«‹å³æ”¯ä»˜ Â¥2.99</div>
            </div>
        </button>
        
        <button class="btn free-btn" onclick="share()">
            <div style="text-align:center;width:100%;">åˆ†äº«ç»™æœ‹å‹ä¸€èµ·æµ‹</div>
        </button>
        
        <p class="tip">ç»“æœä»…ä¾›å‚è€ƒï¼Œä¸ä½œä¸ºæƒ…æ„Ÿå»ºè®®</p>
    </div>

    <!-- æ”¯ä»˜é¡µ -->
    <div class="container" id="paypage" style="display:none;">
        <span class="tag">å®‰å…¨æ”¯ä»˜</span>
        <h1>ç¡®è®¤æ”¯ä»˜</h1>
        <p class="subtitle">Â¥2.99 è§£é”æ·±åº¦ç‰ˆ</p>
        
        <div class="feature-box">
            <div class="detail-item"><span>ä¾æ‹ç±»å‹æ·±åº¦è§£è¯»</span><span>âœ…</span></div>
            <div class="detail-item"><span>åŸç”Ÿå®¶åº­åˆ†æ</span><span>âœ…</span></div>
            <div class="detail-item"><span>æ‹çˆ±æ¨¡å¼æˆå› </span><span>âœ…</span></div>
            <div class="detail-item"><span>ç²¾ç¥åˆ†æè§£è¯»</span><span>âœ…</span></div>
        </div>
        
        <button class="btn wechat-pay" onclick="paySuccess()">
            <div style="text-align:center;width:100%;"><div class="btn-title">å¾®ä¿¡æ”¯ä»˜ Â¥2.99</div></div>
        </button>
        
        <button class="btn alipay" style="margin-top:10px;">
            <div style="text-align:center;width:100%;"><div class="btn-title">æ”¯ä»˜å®æ”¯ä»˜ Â¥2.99</div></div>
        </button>
        
        <button class="btn" style="margin-top:15px;background:#999;" onclick="back()">
            <div style="text-align:center;width:100%;">è¿”å›</div>
        </button>
    </div>

    <!-- å®Œæ•´æŠ¥å‘Šé¡µ -->
    <div class="container result" id="fullreport" style="display:none;">
        <span class="tag" style="background:#07c160;">ğŸ‰ æ”¯ä»˜æˆåŠŸ</span>
        
        <div class="attachment-type" id="emoji2">ğŸ’•</div>
        <div class="type-name" id="typeName2">å®‰å…¨å‹</div>
        <div class="type-desc" id="typeDesc2">ä½ æ‹¥æœ‰å¥åº·çš„ä¾æ‹æ¨¡å¼</div>
        
        <!-- åŸç”Ÿå®¶åº­ -->
        <div class="psycho-section">
            <h4>ğŸ  åŸç”Ÿå®¶åº­å½±å“åˆ†æ</h4>
            <div class="psycho-content" id="familyAnalysis"></div>
        </div>
        
        <!-- æ‹çˆ±æ¨¡å¼ -->
        <div class="psycho-section">
            <h4>ğŸ’” æ‹çˆ±æ¨¡å¼æˆå› </h4>
            <div class="psycho-content" id="patternAnalysis"></div>
        </div>
        
        <!-- å…³ç³»å»ºè®® -->
        <div class="feature-box">
            <h4>ğŸ’¡ å…³ç³»æ”¹è¿›å»ºè®®</h4>
            <div id="relationshipAdvice"></div>
        </div>
        
        <!-- ç²¾ç¥åˆ†æ -->
        <div class="psycho-section">
            <h4>ğŸ§  æ½œæ„è¯†ç²¾ç¥åˆ†æ</h4>
            <div class="psycho-content" id="psychoContent"></div>
        </div>
        
        <button class="btn" style="background:#07c160;margin-top:20px;" onclick="downloadReport()">
            <div style="text-align:center;width:100%;"><div class="btn-title">ä¿å­˜æŠ¥å‘Šåˆ°ç›¸å†Œ</div></div>
        </button>
        
        <button class="btn" style="margin-top:10px;" onclick="share()">
            <div style="text-align:center;width:100%;">åˆ†äº«ç»™æœ‹å‹</div></div>
        </button>
        
        <p class="tip">ç»“æœä»…ä¾›å‚è€ƒï¼Œä¸ä½œä¸ºæƒ…æ„Ÿå»ºè®®</p>
    </div>

    <script>
        const questions = [
            // ç„¦è™‘ç»´åº¦
            "å½“æ‹äººæ²¡æœ‰åŠæ—¶å›å¤æ¶ˆæ¯æ—¶ï¼Œä½ ä¼šï¼š",
            "æ‹çˆ±ä¸­ï¼Œä½ ç»å¸¸æ‹…å¿ƒå¤±å»å¯¹æ–¹å—ï¼Ÿ",
            "ä½ å¸Œæœ›æ‹äººç»å¸¸è¡¨è¾¾çˆ±æ„å—ï¼Ÿ",
            "äº‰åµåï¼Œä½ ä¼šåå¤æ€è€ƒè°å¯¹è°é”™å—ï¼Ÿ",
            "ä½ ä¼šç»å¸¸æŸ¥çœ‹æ‹äººçš„ç¤¾äº¤åŠ¨æ€å—ï¼Ÿ",
            // å›é¿ç»´åº¦
            "æ‹çˆ±ä¸­ä½ éœ€è¦ä¸ªäººç©ºé—´å—ï¼Ÿ",
            "è¡¨è¾¾æƒ…æ„Ÿå¯¹ä½ æ¥è¯´å›°éš¾å—ï¼Ÿ",
            "ä½ å€¾å‘äºåœ¨å…³ç³»ä¸­ä¿æŒç‹¬ç«‹å—ï¼Ÿ",
            "å½“å…³ç³»å˜äº²å¯†æ—¶ï¼Œä½ æƒ³åé€€å—ï¼Ÿ",
            "ä½ ä¸å–œæ¬¢ä¾èµ–æ‹äººå—ï¼Ÿ",
            // æ·±å…¥
            "ä½ çš„ç«¥å¹´ç»å†ä¸»è¦ä¸è°åœ¨ä¸€èµ·ï¼Ÿ",
            "çˆ¶æ¯å…³ç³»å¯¹ä½ çš„å½±å“æ˜¯ï¼Ÿ",
            "åˆæ‹ç»å†è®©ä½ å¯¹çˆ±æƒ…æ›´ï¼š",
            "æ‹çˆ±ä¸­ä½ æœ€å®³æ€•çš„æ˜¯ï¼š",
            "ä½ é€šå¸¸å¦‚ä½•è¡¨è¾¾çˆ±æ„ï¼Ÿ",
            // ä¾æ‹è¡Œä¸º
            "æ‹äººæƒ¹ä½ ç”Ÿæ°”æ—¶ï¼Œä½ ä¼šï¼š",
            "ä½ ä¼šåœ¨ç¤¾äº¤åª’ä½“ä¸Šç§€æ©çˆ±å—ï¼Ÿ",
            "æ‹çˆ±ä¸­ä½ ä¼šç»å¸¸å¦¥åå—ï¼Ÿ",
            "ä½ ç›¸ä¿¡æ°¸æ’çš„çˆ±æƒ…å—ï¼Ÿ",
            "å¦‚æœå¤±æ‹ï¼Œä½ ä¼šï¼š",
            // å…³ç³»é¢„æœŸ
            "ä½ ç†æƒ³çš„æ‹çˆ±èŠ‚å¥æ˜¯ï¼š",
            "ä½ ä¼šä¸»åŠ¨è¿½æ±‚è¿˜æ˜¯ç­‰å¾…è¢«è¿½ï¼Ÿ",
            "æ‹çˆ±ä¸­ä½ ä¼šä¿æŒç¥ç§˜æ„Ÿå—ï¼Ÿ",
            "ä½ è®¤ä¸ºçˆ±æƒ…éœ€è¦åŠªåŠ›ç»è¥å—ï¼Ÿ",
            "ä½ ç›¸ä¿¡ç¼˜åˆ†è¿˜æ˜¯åŠªåŠ›ï¼Ÿ"
        ];
        
        const options = [
            ["ç„¦è™‘ï¼Œç«‹åˆ»è”ç³»å¯¹æ–¹", "æ­£å¸¸ç­‰å¾…", "æ— æ‰€è°“"],
            ["ç»å¸¸æ‹…å¿ƒ", "å¶å°”æ‹…å¿ƒ", "ä»ä¸æ‹…å¿ƒ"],
            ["éå¸¸å¸Œæœ›", "é€‚åº¦å°±å¥½", "ä¸éœ€è¦"],
            ["ä¼šçš„ï¼Œåå¤æ€è€ƒ", "ç¨å¾®æƒ³ä¸€ä¸‹", "ä¸æƒ³é‚£ä¹ˆå¤š"],
            ["ç»å¸¸æŸ¥çœ‹", "å¶å°”çœ‹çœ‹", "ä»ä¸"],
            ["éå¸¸éœ€è¦", "é€‚åº¦éœ€è¦", "ä¸éœ€è¦"],
            ["éå¸¸å›°éš¾", "çœ‹æƒ…å†µ", "å¾ˆå®¹æ˜“"],
            ["æ˜¯çš„ï¼Œæˆ‘å–œæ¬¢ç‹¬ç«‹", "çœ‹æƒ…å†µ", "ä¸å–œæ¬¢"],
            ["æ˜¯çš„ï¼Œæƒ³åé€€", "å¶å°”", "ä¸ä¼š"],
            ["æ˜¯çš„ï¼Œä¸å–œæ¬¢ä¾èµ–", "çœ‹æƒ…å†µ", "å–œæ¬¢ä¾èµ–"],
            ["åŒäº²éƒ½åœ¨", "å•äº²", "å…¶ä»–"],
            ["ç§¯æå½±å“", "ä¸€èˆ¬", "è´Ÿé¢å½±å“"],
            ["æ›´åŠ è°¨æ…", "æ²¡æœ‰å½±å“", "æ›´åŠ æŠ•å…¥"],
            ["è¢«æŠ›å¼ƒ", "è¢«æ¬ºéª—", "å¤±å»è‡ªæˆ‘"],
            ["è¯­è¨€è¡¨è¾¾", "è¡ŒåŠ¨è¡¨è¾¾", "ä¸¤è€…éƒ½æœ‰"],
            ["ç›´æ¥è¡¨è¾¾ä¸æ»¡", "å†·æˆ˜", "è¯´å‡ºæ¥å°±å¥½"],
            ["ç»å¸¸", "å¶å°”", "ä»ä¸"],
            ["ç»å¸¸å¦¥å", "å¶å°”", "å¾ˆå°‘"],
            ["ç›¸ä¿¡", "åŠä¿¡åŠç–‘", "ä¸ç›¸ä¿¡"],
            ["å¾ˆéš¾è¿‡ä¸€æ®µæ—¶é—´", "å¾ˆå¿«èµ°å‡ºæ¥", "æ²¡ä»€ä¹ˆæ„Ÿè§‰"],
            ["å¿«é€Ÿè¿›å…¥äº²å¯†", "å¾ªåºæ¸è¿›", "æ…¢æ…¢æ¥"],
            ["ä¸»åŠ¨è¿½æ±‚", "ç­‰å¾…è¢«è¿½", "çœ‹æ„Ÿè§‰"],
            ["ä¼šçš„ï¼Œä¿æŒç¥ç§˜", "çœ‹æƒ…å†µ", "å®Œå…¨å¦è¯š"],
            ["éœ€è¦åŠªåŠ›", "é¡ºå…¶è‡ªç„¶", "ä¸å¤ªç›¸ä¿¡"],
            ["ç¼˜åˆ†å¤©æ³¨å®š", "ä¸€åŠä¸€åŠ", "åŠªåŠ›æ›´é‡è¦"]
        ];
        
        // ä¾æ‹ç±»å‹
        const attachmentTypes = {
            secure: { name: "å®‰å…¨å‹", emoji: "ğŸ’•", desc: "ä½ æ‹¥æœ‰å¥åº·çš„ä¾æ‹æ¨¡å¼ï¼Œæ—¢èƒ½äº«å—äº²å¯†ï¼Œåˆèƒ½ä¿æŒç‹¬ç«‹ã€‚ä½ ç›¸ä¿¡è‡ªå·±å€¼å¾—è¢«çˆ±ï¼Œä¹Ÿä¿¡ä»»ä¼´ä¾£ã€‚" },
            anxious: { name: "ç„¦è™‘å‹", emoji: "ğŸ’”", desc: "ä½ æ¸´æœ›äº²å¯†ä½†åˆå®³æ€•è¢«æŠ›å¼ƒï¼Œç»å¸¸æ„Ÿåˆ°ä¸å®‰ã€‚ä½ éœ€è¦ä¼´ä¾£ä¸æ–­ç¡®è®¤çˆ±æ„ï¼Œå®¹æ˜“è¿‡åº¦ä¾èµ–ã€‚" },
            avoidant: { name: "å›é¿å‹", emoji: "ğŸ’¤", desc: "ä½ é‡è§†ç‹¬ç«‹ç©ºé—´ï¼Œä¸å–œæ¬¢è¿‡åº¦äº²å¯†ã€‚ä½ å¯èƒ½åœ¨æƒ…æ„Ÿä¸Šä¿æŒè·ç¦»ï¼Œä»¥å…å—ä¼¤ã€‚" },
            fearful: { name: "æ··ä¹±å‹", emoji: "ğŸ’”", desc: "ä½ çš„æ‹çˆ±æ¨¡å¼å¤æ‚ï¼Œæ—¢æ¸´æœ›äº²å¯†åˆå®³æ€•å—ä¼¤ã€‚æƒ…æ„Ÿèµ·ä¼å¤§ï¼Œå®¹æ˜“é™·å…¥çŸ›ç›¾å…³ç³»ã€‚" }
        };
        
        let current = 0;
        let answers = [];
        let totalQuestions = 25;
        let anxiety = 0; // ç„¦è™‘åˆ†æ•°
        let avoidance = 0; // å›é¿åˆ†æ•°

        function start(count) {
            totalQuestions = count;
            current = 0;
            answers = [];
            anxiety = 0;
            avoidance = 0;
            document.getElementById('home').style.display = 'none';
            document.getElementById('quiz').classList.add('active');
            showQuestion();
        }

        function showQuestion() {
            document.getElementById('progress-text').textContent = `${current + 1}/${totalQuestions}`;
            document.getElementById('progress-fill').style.width = `${((current + 1) / totalQuestions) * 100}%`;
            document.getElementById('questionText').textContent = questions[current];
            
            const opts = document.getElementById('options');
            opts.innerHTML = '';
            options[current].forEach((opt, i) => {
                const btn = document.createElement('button');
                btn.className = 'option';
                btn.textContent = opt;
                btn.onclick = () => select(i);
                opts.appendChild(btn);
            });
        }

        function select(i) {
            answers.push(i);
            
            // è®¡ç®—ç„¦è™‘åˆ†æ•° (å‰5é¢˜)
            if (current < 5) {
                anxiety += (2 - i); // 0=2, 1=1, 2=0
            }
            // è®¡ç®—å›é¿åˆ†æ•° (5-10é¢˜)
            if (current >= 5 && current < 10) {
                avoidance += i; // 0=0, 1=1, 2=2
            }
            
            if (current < totalQuestions - 1) {
                current++;
                showQuestion();
            } else {
                showCalculating();
            }
        }

        function showCalculating() {
            document.getElementById('quiz').classList.remove('active');
            document.getElementById('calculating').classList.add('active');
            
            setTimeout(() => {
                document.getElementById('calculating').classList.remove('active');
                showResult();
            }, 1500);
        }

        function showResult() {
            // å½’ä¸€åŒ–
            anxiety = Math.max(0, Math.min(10, anxiety));
            avoidance = Math.max(0, Math.min(10, avoidance));
            
            // ç¡®å®šç±»å‹
            let type = "secure";
            if (anxiety >= 5 && avoidance >= 5) type = "fearful";
            else if (anxiety >= 5) type = "anxious";
            else if (avoidance >= 5) type = "avoidant";
            
            const result = attachmentTypes[type];
            
            document.getElementById('emoji').textContent = result.emoji;
            document.getElementById('typeName').textContent = result.name;
            document.getElementById('typeDesc').textContent = result.desc;
            
            // æ›´æ–°ç»´åº¦
            document.getElementById('anxietyLevel').textContent = anxiety >= 5 ? "é«˜" : (anxiety >= 3 ? "ä¸­" : "ä½");
            document.getElementById('avoidanceLevel').textContent = avoidance >= 5 ? "é«˜" : (avoidance >= 3 ? "ä¸­" : "ä½");
            
            // æ‹çˆ±ç‰¹å¾
            document.getElementById('intimacyNeed').textContent = anxiety >= 5 ? "é«˜" : "é€‚ä¸­";
            document.getElementById('independenceNeed').textContent = avoidance >= 5 ? "é«˜" : "é€‚ä¸­";
            document.getElementById('expressionStyle').textContent = type === "avoidant" ? "å«è“„" : "ç›´æ¥";
            
            if (totalQuestions >= 25) {
                document.getElementById('locked-section').classList.add('show');
                document.getElementById('payBtn').classList.add('show');
            }
            
            document.getElementById('result').classList.add('active');
        }

        function showPay() {
            document.getElementById('result').classList.remove('active');
            document.getElementById('paypage').style.display = 'block';
        }

        function back() {
            document.getElementById('paypage').style.display = 'none';
            document.getElementById('result').classList.add('active');
        }

        function paySuccess() {
            document.getElementById('paypage').style.display = 'none';
            document.getElementById('fullreport').style.display = 'block';
            
            const type = document.getElementById('typeName').textContent;
            const result = Object.values(attachmentTypes).find(r => r.name === type) || attachmentTypes.secure;
            
            document.getElementById('emoji2').textContent = result.emoji;
            document.getElementById('typeName2').textContent = result.name;
            document.getElementById('typeDesc2').textContent = result.desc;
            
            // ç”Ÿæˆåˆ†æ
            generateDeepAnalysis(type);
        }

        function generateDeepAnalysis(type) {
            // åŸç”Ÿå®¶åº­
            const familyTexts = {
                "å®‰å…¨å‹": "ä½ åœ¨æœ‰çˆ±ä¸”ç¨³å®šçš„ç¯å¢ƒä¸­æˆé•¿ï¼Œçˆ¶æ¯å…³ç³»å’Œè°ï¼Œè®©ä½ å»ºç«‹äº†å¯¹äº²å¯†å…³ç³»çš„ä¿¡ä»»ã€‚",
                "ç„¦è™‘å‹": "å¯èƒ½ç”±äºç«¥å¹´ç…§é¡¾è€…çš„ä¸ç¨³å®šï¼ˆæ—¶å†·æ—¶çƒ­ï¼‰ï¼Œè®©ä½ å¯¹äº²å¯†å…³ç³»äº§ç”Ÿä¸å®‰å…¨æ„Ÿã€‚",
                "å›é¿å‹": "å¯èƒ½ç”±äºç«¥å¹´æƒ…æ„Ÿéœ€æ±‚æœªè¢«æ»¡è¶³ï¼Œæˆ–è¿‡åº¦æ§åˆ¶ï¼Œè®©ä½ å­¦ä¼šäº†æƒ…æ„Ÿç‹¬ç«‹ã€‚",
                "æ··ä¹±å‹": "å¯èƒ½ç»å†äº†å¤æ‚çš„å®¶åº­ç¯å¢ƒï¼Œå¦‚çˆ¶æ¯å†²çªã€å¿½è§†æˆ–è™å¾…ï¼Œå¯¼è‡´ä¾æ‹ç³»ç»Ÿç´Šä¹±ã€‚"
            };
            document.getElementById('familyAnalysis').innerHTML = "<p>" + (familyTexts[type] || "") + "</p>";
            
            // æ‹çˆ±æ¨¡å¼æˆå› 
            const patternTexts = {
                "å®‰å…¨å‹": "ä½ å½¢æˆäº†å¥åº·çš„'å†…éƒ¨å·¥ä½œæ¨¡å‹'ï¼Œç›¸ä¿¡è‡ªå·±å€¼å¾—è¢«çˆ±ï¼Œä¹Ÿç›¸ä¿¡ä»–äººæ˜¯å¯ä¿¡ä»»çš„ã€‚",
                "ç„¦è™‘å‹": "ä½ çš„'å†…éƒ¨å·¥ä½œæ¨¡å‹'è®¤ä¸º'æˆ‘ä¸å¤Ÿå¥½'ä¸”'ä»–äººä¸å¯é 'ï¼Œå¯¼è‡´å¯¹è¢«æŠ›å¼ƒçš„ææƒ§ã€‚",
                "å›é¿å‹": "ä½ å½¢æˆäº†'æˆ‘ä¸éœ€è¦åˆ«äºº'çš„é˜²å¾¡æ¨¡å¼ï¼Œé€šè¿‡æƒ…æ„Ÿéš”ç¦»æ¥ä¿æŠ¤è‡ªå·±ã€‚",
                "æ··ä¹±å‹": "ä½ çš„ä¾æ‹ç³»ç»ŸåŒæ—¶è¢«æ¿€æ´»äº†äº²å¯†éœ€æ±‚å’Œé€ƒé¿å†²åŠ¨ï¼Œå¯¼è‡´åœ¨å…³ç³»ä¸­çŸ›ç›¾é‡é‡ã€‚"
            };
            document.getElementById('patternAnalysis').innerHTML = "<p>" + (patternTexts[type] || "") + "</p>";
            
            // å…³ç³»å»ºè®®
            const adviceTexts = {
                "å®‰å…¨å‹": "ç»§ç»­ä¿æŒï¼ä½ å¯ä»¥å°è¯•æ›´å¤šè¡¨è¾¾æƒ…æ„Ÿï¼Œå¸®åŠ©ä¼´ä¾£ç†è§£ä½ çš„éœ€æ±‚ã€‚",
                "ç„¦è™‘å‹": "å»ºè®®ï¼š1.å»ºç«‹è‡ªå·±çš„ç¤¾äº¤åœˆä¸è¿‡åº¦ä¾èµ–æ‹äºº 2.ç»ƒä¹ æƒ…ç»ªè‡ªæˆ‘å®‰æŠš 3.ä¸ä¼´ä¾£å¦è¯šæ²Ÿé€šéœ€æ±‚ã€‚",
                "å›é¿å‹": "å»ºè®®ï¼š1.å°è¯•é€‚åº¦æ‰“å¼€å¿ƒæ‰‰ 2.è®¤è¯†åˆ°ç‹¬ç«‹ä¸äº²å¯†å¯ä»¥å¹¶å­˜ 3.æ¥å—ä¼´ä¾£çš„æ”¯æŒã€‚",
                "æ··ä¹±å‹": "å»ºè®®ï¼š1.å¯»æ±‚ä¸“ä¸šå¸®åŠ©ç†æ¸…ä¾æ‹æ¨¡å¼ 2.å­¦ä¼šè¯†åˆ«è‡ªå·±çš„çœŸå®æ„Ÿå— 3.å»ºç«‹å¥åº·çš„å…³ç³»è¾¹ç•Œã€‚"
            };
            document.getElementById('relationshipAdvice').innerHTML = "<p style='font-size:13px;color:#666;'>" + (adviceTexts[type] || "") + "</p>";
            
            // ç²¾ç¥åˆ†æ
            let psycho = "";
            if (type === "å®‰å…¨å‹") {
                psycho = "<p>ä»<span class='highlight'>ç²¾ç¥åˆ†æ</span>è§’åº¦ï¼Œä½ çš„<span class='term'>å®¢ä½“å…³ç³»</span>å‘å±•è‰¯å¥½ï¼Œæ—©æœŸç…§é¡¾è€…æ»¡è¶³äº†ä½ çš„<span class='highlight'>æƒ…æ„Ÿéœ€æ±‚</span>ï¼Œè®©ä½ å½¢æˆäº†<span class='term'>å®‰å…¨åŸºåœ°</span>ã€‚ä½ çš„<span class='highlight'>è¶…æˆ‘</span>ä¸<span class='term'>æœ¬æˆ‘</span>è¾ƒä¸ºå’Œè°ï¼Œèƒ½å¤Ÿ<span class='highlight'>å¥åº·åœ°</span>å¤„ç†äº²å¯†å…³ç³»ã€‚</p>";
            } else if (type === "ç„¦è™‘å‹") {
                psycho = "<p>ä»<span class='highlight'>ç²¾ç¥åˆ†æ</span>è§’åº¦ï¼Œä½ çš„<span class='term'>ä¾æ‹</span>å‘ˆç°<span class='highlight'>çŸ›ç›¾æ€§</span>ã€‚è¿™æºäº<span class='term'>æ—©æœŸå®¢ä½“</span>çš„ä¸ç¨³å®šâ€”â€”ç…§é¡¾è€…<span class='highlight'>æ—¶å¥½æ—¶å</span>ï¼Œè®©ä½ å½¢æˆäº†<span class='term'>æ··åˆå‹ä¾æ‹</span>ã€‚ä½ åœ¨<span class='highlight'>äº²å¯†</span>ä¸<span class='term'>ç„¦è™‘</span>ä¹‹é—´æŒ£æ‰ï¼Œ<span class='term'>è¶…æˆ‘</span>è¿‡å¼ºå¯¼è‡´<span class='highlight'>è‡ªæˆ‘</span>ä»·å€¼æ„Ÿä½ã€‚å»ºè®®é€šè¿‡<span class='term'>å¿ƒç†å’¨è¯¢</span>ä¿®å¤<span class='highlight'>æ—©æœŸåˆ›ä¼¤</span>ã€‚</p>";
            } else if (type === "å›é¿å‹") {
                psycho = "<p>ä»<span class='highlight'>ç²¾ç¥åˆ†æ</span>è§’åº¦ï¼Œä½ å‘å±•äº†<span class='term'>æƒ…æ„Ÿéš”ç¦»</span>è¿™ä¸€<span class='highlight'>é˜²å¾¡æœºåˆ¶</span>ã€‚æ—©æœŸç»å†å‘Šè¯‰ä½ <span class='term'>ä¾èµ–ä»–äººæ˜¯å±é™©çš„</span>ï¼Œæ‰€ä»¥ä½ ç”¨<span class='highlight'>å‹æŠ‘</span>æƒ…æ„Ÿéœ€æ±‚æ¥ä¿æŠ¤è‡ªå·±ã€‚è¿™æ˜¯ä¸€ç§<span class='term'>åˆçº§é˜²å¾¡</span>ï¼Œè™½ç„¶ä¿æŠ¤äº†ä½ ï¼Œä½†ä¹Ÿé˜»ç¢äº†<span class='highlight'>æ·±åº¦äº²å¯†</span>ã€‚å»ºè®®å°è¯•<span class='term'>é€æ­¥æ‰“å¼€</span>å†…å¿ƒï¼Œä¿¡ä»»ä»–äººã€‚</p>";
            } else {
                psycho = "<p>ä»<span class='highlight'>ç²¾ç¥åˆ†æ</span>è§’åº¦ï¼Œä½ çš„<span class='term'>ä¾æ‹ç³»ç»Ÿ</span>å¤„äº<span class='highlight'>æ··ä¹±</span>çŠ¶æ€ã€‚è¿™æ˜¯æœ€å¤æ‚çš„<span class='term'>é˜²å¾¡ç»“æ„</span>â€”â€”ä½ æ—¢æ¸´æœ›<span class='highlight'>äº²å¯†</span>åˆå®³æ€•<span class='term'>è¢«åå™¬</span>ã€‚è¿™å¯èƒ½æºäº<span class='highlight'>æ—©æœŸåˆ›ä¼¤</span>ï¼ˆå¦‚è™å¾…ã€ä¸¥é‡å¿½è§†ï¼‰ã€‚åœ¨<span class='term'>ç²¾ç¥åˆ†æ</span>ä¸­ï¼Œä½ éœ€è¦<span class='highlight'>é‡å»º</span>å¯¹<span class='term'>å®¢ä½“</span>çš„ä¿¡ä»»ã€‚å»ºè®®<span class='highlight'>å¯»æ±‚ä¸“ä¸šå¸®åŠ©</span>ã€‚</p>";
            }
            
            psycho += "<p style='margin-top:15px;'><span class='highlight'>åˆ†æå¸ˆè¯´ï¼š</span>ä¾æ‹ç±»å‹ä¸æ˜¯å‘½è¿ï¼Œè€Œæ˜¯<span class='term'>å¯æ”¹å˜</span>çš„ã€‚é€šè¿‡<span class='highlight'>è‡ªæˆ‘è§‰å¯Ÿ</span>å’Œ<span class='term'>å®‰å…¨å…³ç³»</span>çš„ä½“éªŒï¼Œä½ å¯ä»¥é€æ­¥<span class='highlight'>ä¿®å¤</span>ä¾æ‹æ¨¡å¼ã€‚</p>";
            
            document.getElementById('psychoContent').innerHTML = psycho;
        }

        function downloadReport() {
            alert('æŠ¥å‘Šå·²ä¿å­˜ï¼');
        }

        function share() {
            alert('è¯·åˆ†äº«ç»™æœ‹å‹~');
        }
    </script>
</body>
</html>
